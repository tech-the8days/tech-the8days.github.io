---
layout: post
title: "Hello AWS!"
author: "Tyler"
profile_img: "https://scontent-hkg3-1.xx.fbcdn.net/v/t1.0-9/936642_905500386224645_7113704243429636156_n.jpg?oh=cfae00146c94276e9091d646d4232dd1&oe=5A9EF71A"
---

<body>
    <div id="doc" class="markdown-body container-fluid" style="position: relative;"><h1 id="hello-aws"><a class="anchor hidden-xs" href="#hello-aws" title="hello-aws"><span class="octicon octicon-link"></span></a>Hello AWS!</h1><p>AWS를 공부하면서 포스팅을 시작하기로 했다. 이번 포스팅에서는 AWS 시작부터, 인스턴스에 간단한 웹서버를 띄우는 것 까지 진행해 보기로 한다.</p><h2 id="진행-순서"><a class="anchor hidden-xs" href="#진행-순서" title="진행-순서"><span class="octicon octicon-link"></span></a>진행 순서</h2><pre class="flow-chart"><svg height="504" version="1.1" width="163.484375" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; top: -0.78125px;" viewBox="0 0 163.484375 504" preserveAspectRatio="xMidYMid meet"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.2.0</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endblock33-objk4rog" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objw9wkw" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-obj22j1a" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objcq0k1" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objefusp" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="0" y="0" width="69.390625" height="38" rx="20" ry="20" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="start" transform="matrix(1,0,0,1,48.0469,4)"></rect><text x="10" y="19" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" id="startt" class="flowchartt" transform="matrix(1,0,0,1,48.0469,4)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="6">Start</tspan></text><rect x="0" y="0" width="154.53125" height="38" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="vpc" transform="matrix(1,0,0,1,5.4766,96)"></rect><text x="10" y="19" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" id="vpct" class="flowchartt" transform="matrix(1,0,0,1,5.4766,96)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="6">VPC 네트워크 구성</tspan></text><rect x="0" y="0" width="154.53125" height="38" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="ec2" transform="matrix(1,0,0,1,5.4766,188)"></rect><text x="10" y="19" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" id="ec2t" class="flowchartt" transform="matrix(1,0,0,1,5.4766,188)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="6">EC2 인스턴스 생성</tspan></text><rect x="0" y="0" width="87.8125" height="38" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="eip" transform="matrix(1,0,0,1,38.8359,280)"></rect><text x="10" y="19" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" id="eipt" class="flowchartt" transform="matrix(1,0,0,1,38.8359,280)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="6">EIP 할당</tspan></text><rect x="0" y="0" width="157.484375" height="38" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="web_server" transform="matrix(1,0,0,1,4,372)"></rect><text x="10" y="19" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" id="web_servert" class="flowchartt" transform="matrix(1,0,0,1,4,372)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="6">Web server 구성</tspan></text><rect x="0" y="0" width="49.484375" height="38" rx="20" ry="20" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="end" transform="matrix(1,0,0,1,58,464)"></rect><text x="10" y="19" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" id="endt" class="flowchartt" transform="matrix(1,0,0,1,58,464)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="6">End</tspan></text><path fill="none" stroke="#000000" d="M82.7421875,42C82.7421875,42,82.7421875,81.65409994125366,82.7421875,93.00043908460066" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objk4rog)" font-family="'Andale Mono', monospace" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;"></path><path fill="none" stroke="#000000" d="M82.7421875,134C82.7421875,134,82.7421875,173.65409994125366,82.7421875,185.00043908460066" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objw9wkw)" font-family="'Andale Mono', monospace" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;"></path><path fill="none" stroke="#000000" d="M82.7421875,226C82.7421875,226,82.7421875,265.65409994125366,82.7421875,277.00043908460066" stroke-width="2" marker-end="url(#raphael-marker-endblock33-obj22j1a)" font-family="'Andale Mono', monospace" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;"></path><path fill="none" stroke="#000000" d="M82.7421875,318C82.7421875,318,82.7421875,357.65409994125366,82.7421875,369.00043908460066" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objcq0k1)" font-family="'Andale Mono', monospace" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;"></path><path fill="none" stroke="#000000" d="M82.7421875,410C82.7421875,410,82.7421875,449.65409994125366,82.7421875,461.00043908460066" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objefusp)" font-family="'Andale Mono', monospace" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;"></path></svg></pre><p>가장 먼저, Private 네트워크 구축을 위해 <em>VPC(Virtual Private Cloud)</em> 네트워크를 생성한다.<br>
두 번째로 <em>EC2</em> 인스턴스를 생성하는데, 이 인스턴스에는 데이터베이스와 연동되는 간단한 웹 서버가 올라간다.<br>
세 번째로 생성 된 <em>EC2</em> 인스턴스에 외부와 통신을 위한 IP 할당을 위해 <em>EIP</em>를 할당한다.<br>
마지막으로 <em>Node.js</em>의 <code>express</code> 모듈을 사용해 간단한 웹 서버를 올리는 것으로 마무리한다.</p><h2 id="vpc-구성"><a class="anchor hidden-xs" href="#vpc-구성" title="vpc-구성"><span class="octicon octicon-link"></span></a>VPC 구성</h2><p><strong>Dashboard -&gt; Networking &amp; Content Delivery -&gt; VPC</strong><br>
사전지식이 없으므로 <code>Start VPC Wizard</code>로 미리 셋팅 된 Configuration으로 VPC를 구성한다.</p><h3 id="step1-select-vpc-configuration"><a class="anchor hidden-xs" href="#step1-select-vpc-configuration" title="step1-select-vpc-configuration"><span class="octicon octicon-link"></span></a>Step1: Select VPC Configuration</h3><ol>
<li>VPC with a Single Public Subnet<br>
: 하나의 <em>subnet</em>으로 구성 된 간단한 네트워크</li>
<li>VPC with a Public and Private Subnet<br>
: <code>Public subnet</code>과 <code>Private subnet</code>으로 구성된 네트워크. <strong>반드시 하나 이상의 <code>Private subnet</code>을 포함해야 한다.</strong> <code>Private subnet</code>은 인터넷 게이트웨이로 라우팅 하는 규칙이 없어서 반드시 <code>Public subnet</code>을 거쳐야만 연결할 수 있다.</li>
<li>VPC with Public and Private Subnets and VPN Access<br>
: 위 2번 구성은 보안성을 높일 수 있다는 장점이 있지만, 관리가 복잡하다. 개발자가 <code>Private subnet</code>에 있는 데이터 베이스에 직접 접근 할 수도 없다. 그래서 네트워크와 네트워크를 서로 연결해 하나의 네트워크 처럼 만드는 기술인 <em>VPN(Virtual Private Network)</em> 을 사용하는 구성이다. <em>VPN</em> 은 암호화 되어있고, <strong>개발자가 어느 곳에 있든지 VPC에 접근 할 수 있다.</strong></li>
<li>VPC with a Private Subnet Only and VPN Access<br>
: <code>Public subent</code>이 없어서 인터넷 서비스는 사용 할 수 없다. 회사 내부에서만 사용 할 데이터 센터를 AWS 상에 구축한다.</li>
</ol><p>Hello AWS 프로젝트는 프로토타이핑의 목적이므로 <em>VPC with a Single Public Subnet</em>을 통해 진행한다.</p><h3 id="step2"><a class="anchor hidden-xs" href="#step2" title="step2"><span class="octicon octicon-link"></span></a>Step2</h3><p><strong>용어 설명</strong></p><ul>
<li>IP <a href="https://ko.wikipedia.org/wiki/%EC%82%AC%EC%9D%B4%EB%8D%94_(%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%82%B9)" target="_blank">CIDR</a> block: VPC 네트워크에서 사용할 IP 주소 대역을 지정한다.</li>
<li>Availability Zone: AWS 리전은 하나 이상의 <code>Availability Zone</code>으로 구성되는데, 물리적으로 완전히 분리된 AWS의 인프라 단위이다. 사용을 위해선 두 개 이상의 서브넷을 만들고, 각 서브넷이 서로 다른 <code>Availability Zone</code>에 위치하게 설정해야 한다.</li>
<li>Enable DNS hostnames: VPC 네트워크를 위한 DNS 서비스 이용 여부</li>
<li>Hardware tenancy: 단일 고객에게만 인스턴스를 할당할 지의 여부</li>
</ul><h2 id="ec2-구성"><a class="anchor hidden-xs" href="#ec2-구성" title="ec2-구성"><span class="octicon octicon-link"></span></a>EC2 구성</h2><p><strong>Dashboard -&gt; Compute -&gt; EC2</strong><br>
<code>Launch Instance</code>를 클릭해 간단한 웹 서버를 올릴 EC2 인스턴스를 생성한다.</p><h3 id="step1-choose-an-amazon-machine-imageami"><a class="anchor hidden-xs" href="#step1-choose-an-amazon-machine-imageami" title="step1-choose-an-amazon-machine-imageami"><span class="octicon octicon-link"></span></a>Step1: Choose an Amazon Machine Image(AMI)</h3><p>EC2 인스턴스에서 사용 할 OS를 선택한다. 미리 세팅 된 Custom OS도 AWS Marketplace에서 제공한다. 표준 AMI 중 <strong>Ubuntu Server 16.04 LTS (HVM), SSD Volume Type</strong>를 선택해 진행한다.</p><h3 id="step2-choose-an-instance-type"><a class="anchor hidden-xs" href="#step2-choose-an-instance-type" title="step2-choose-an-instance-type"><span class="octicon octicon-link"></span></a>Step2: Choose an Instance Type</h3><p>서버의 사양을 정하는 단계이다. vCPU는 <em>Virtual CPU</em>를 의미한다. CPU나 메모리 스펙보다는 목적에 최적화 된 <code>Family</code>를 선택하는 것이 중요하다.</p><p>기본 Family인 General purpose에 t2.micro Type을 선택한다.</p><h3 id="step-3-configure-instance-details"><a class="anchor hidden-xs" href="#step-3-configure-instance-details" title="step-3-configure-instance-details"><span class="octicon octicon-link"></span></a>Step 3: Configure Instance Details</h3><p>네트워크 세부 설정 단계이다.<br>
해당 프로젝트는 세부 설정을 하지 않고, <em>VPC</em>만 <em>default</em>가 아닌 기존 설정했던 <em>VPC</em>와, <em>Subnet</em>을 선택한다.</p><h3 id="step-4-add-storage"><a class="anchor hidden-xs" href="#step-4-add-storage" title="step-4-add-storage"><span class="octicon octicon-link"></span></a>Step 4: Add Storage</h3><p>Storage의 파티션과 사이즈를 선택하는 단계이다. Root는 운영체제가 이용하는 공간이므로 <code>Add New Volume</code>으로 EBS 8G 볼륨을 추가한다.</p><h3 id="step-5-add-tags"><a class="anchor hidden-xs" href="#step-5-add-tags" title="step-5-add-tags"><span class="octicon octicon-link"></span></a>Step 5: Add Tags</h3><p>인스턴스에 태그를 달아 관리하기 위한 단계이다. key/value로 이루어진다.</p><h3 id="step-6-configure-security-group"><a class="anchor hidden-xs" href="#step-6-configure-security-group" title="step-6-configure-security-group"><span class="octicon octicon-link"></span></a>Step 6: Configure Security Group</h3><p>일종의 네트워크 방화벽으로, 허락한 패킷만 흐르도록 제어한다.<br>
웹 서버를 띄우기 위해 기존 정의 된 <code>HTTP</code>를 Type을 추가해준다.<br>
접근 대상을 한정하고 싶다면 <code>Source</code>를 수정한다.</p><h3 id="step-7-review-instance-launch"><a class="anchor hidden-xs" href="#step-7-review-instance-launch" title="step-7-review-instance-launch"><span class="octicon octicon-link"></span></a>Step 7: Review Instance Launch</h3><p>지금까지 설정했던 세부 사항을 리뷰하는 단계이다. 이상이 없다면 <code>Launch</code>를 클릭해 인스턴스 접근하기위한 <strong>ssh key pair</strong>를 설정한다.<br>
SSH key-pair를 이용한 유저 인증에는 <code>Public key</code>와 <code>Private key</code>가 사용되고, <code>Create a new key pair</code>를 선택해 새로운 개인키와 공용키 쌍을 만들 수 있다. <code>Public key</code>는 인스턴스에 설치되고, <code>Private key</code>는 유저가 다운로드 받고 이 키로 인스턴스에 접근할 수 있다. <code>Private key</code>는 최초에 한 번 다운로드 받을 수 있다.<br>
키 발급을 마치면, <code>Launch Instances</code>로 인스턴스 생성을 완료한다.</p><h2 id="eip-할당"><a class="anchor hidden-xs" href="#eip-할당" title="eip-할당"><span class="octicon octicon-link"></span></a>EIP 할당</h2><p><strong>EC2 -&gt; NETWORK &amp; SECURITY -&gt; Elastic IPs</strong><br>
인스턴스 생성을 완료하면, 인스턴스가 실행된다. 아직 인스턴스는 VPC에서 할당한 사설 IP만 가지고 있고, EIP(Elastic IP)를 할당해서 인터넷과 연결고리를 만든다. EIP는 <em>Public IP</em>의 다른 형태다. 외부와 통신하기 위해 <em>Public IP</em>를 할당 받는 것은 같지만, EIP는 사용자의 소유로 고정되고 원하는 인스턴스에 붙이거나 뗄 수 있다.<br>
단순히 <code>Allocate New Address</code>를 클릭해서 할당 받을 수 있다. 할당받은 EIP를 특정 인스턴스의 <code>Private IP</code>에 매핑한다. <code>Actions</code>의 <code>Accociate Address</code>를 통해 매핑할 수 있다.<br>
매핑 후 <code>ssh -i my_key.pem ubuntu@xxx.xxx.xxx.xxx</code> 명령어를 통해 인스턴스에 접근 할 수 있다.</p><pre><code>It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key "my_key.pem": bad permissions
</code></pre><p>해당 메세지가 출력되고 접근이 안될경우, <code>chmod 400 my_key.pem</code>로 파일 권한을 변경 후 다시 시도한다.</p><pre><code>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the ECDSA key sent by the remote host is
SHA256:o0wKrAJV2ChPphM9/bqnPbRntLQb+tGFgOkDGy4ebZg.
Please contact your system administrator.
Add correct host key in /Users/tyler/.ssh/known_hosts to get rid of this message.
Offending ECDSA key in /Users/tyler/.ssh/known_hosts:1
ECDSA host key for xxx.xxx.xxx.xxx has changed and you have requested strict checking.
Host key verification failed.
</code></pre><p>해당 메세지가 출력 될 경우, xxx.xxx.xxx.xxx라는 IP로 기존에 접속한 적이 있는 서버와 RSA 공유키를 교환한 상태에서, xxx.xxx.xxx.xxx라는 서버가 바뀌었기 때문이다. 위의 경고 메시지는 Man in the Middle Attack 이라는 일명 '중간자 공격’에 대해 경고한다. 즉, 기존에 서버가 알고있던 정보를 찾아서 따라갔더니 기존과는 전혀 다른 서버로 접속되었다는 것이다. <code>ssh-keygen -R [ IP or DomainName]</code> 명령어를 통해 초기화 해준다.</p><h2 id="web-server-구성"><a class="anchor hidden-xs" href="#web-server-구성" title="web-server-구성"><span class="octicon octicon-link"></span></a>Web server 구성</h2><h3 id="nodejs-설치"><a class="anchor hidden-xs" href="#nodejs-설치" title="nodejs-설치"><span class="octicon octicon-link"></span></a>Node.js 설치</h3><p>EC2 인스턴스에 접근 후 <code>sudo apt-get update</code> 명령어를 통해 <em>apt pakage manager</em>를 업데이트한다.<br>
업데이트가 완료되면, <code>sudo apt-get install nodejs</code> 명령어로 <em>Node.js</em>를 설치 한다.<br>
<em>Node.js</em>의  웹프레임워크인 <code>express</code>를 사용하기 위해 패키지 관리자 <code>npm</code>을 <code>sudo apt-get install npm</code> 명령어를 통해 설치한다.<br>
<code>npm</code> 설치가 완료되면, <code>npm init</code>으로 default <em>pakage.json</em>을 만들고, <code>npm install --save express</code>로 <em>Node.js</em> 웹프레임워크인 <code>express</code> 모듈을 설치한다.<br>
이제 간단한 웹서버를 만들기 위해 <code>app.js</code> 파일을 만들고, 아래의 코드를 작성한다.</p><pre><code class="{.javascript} hljs"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">var</span> app = express();
app.get(<span class="hljs-string">'/'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>)</span>{
        res.send(<span class="hljs-string">'Hello world'</span>);
});
app.listen(<span class="hljs-number">80</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Connect 80 port'</span>);
});
</code></pre><p>이제 <code>sudo nodejs app.js</code> 명령어로 웹서버를 running 할 수 있다.</p><blockquote>
<p><em>ubuntu</em>에서는 다른 패키지와 충돌을 피하기 위해 우분투 저장소의 실행 파일을 <code>node</code> 대신 <code>nodejs</code> 라고 한다.</p>
</blockquote><p>웹 서버가 잘 동작하는지 확인을 위해서 <code>curl localhost</code>로 확인 해보면 Hello world가 출력되는 모습을 볼 수 있다. 하지만 지금 상태로는 외부 브라우저에서는 해당 웹서버에 접근할 수 없는데, <strong>현재 AWS의 <em>security group</em>이 22번 port만 허용하고 있고 나머지 port는 전부 차단되어 있기 때문이다.</strong> 접근을 위해서는 <em>HTTP</em> port인 80번 port를 열어줘야 한다.</p><h3 id="adding-rule-to-a-security-group"><a class="anchor hidden-xs" href="#adding-rule-to-a-security-group" title="adding-rule-to-a-security-group"><span class="octicon octicon-link"></span></a>Adding Rule to a <em>Security group</em></h3><p><strong>EC2 -&gt; NETWORK &amp; SECURITY -&gt; Security Groups</strong><br>
80번 port를 열려면 <em>EC2</em> 인스턴스의 <em>Security Group</em>에 rule을  추가해 줘야 한다. 관리 화면의 탭을 보면, Inbound / Outbound 가 있는데, 각각 입력/출력 트래픽에 대한 규칙을 설정하는데 사용된다. <code>Edit</code>을 눌러 기존 정의된 <em>HTTP</em> rule을 추가한 후 save한다. 이후 브라우저에서 <em>EIP</em> 주소로 접속하면, 브라우저상에 Hello world가 출력된다.</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav"><li class=""><a href="#hello-aws">Hello AWS!</a><ul class="nav"><li><a href="#진행-순서">진행 순서</a></li><li><a href="#vpc-구성">VPC 구성</a><ul class="nav"><li><a href="#step1-select-vpc-configuration">Step1: Select VPC Configuration</a></li><li><a href="#step2">Step2</a></li></ul></li><li><a href="#ec2-구성">EC2 구성</a><ul class="nav"><li><a href="#step1-choose-an-amazon-machine-imageami">Step1: Choose an Amazon Machine Image(AMI)</a></li><li><a href="#step2-choose-an-instance-type">Step2: Choose an Instance Type</a></li><li><a href="#step-3-configure-instance-details">Step 3: Configure Instance Details</a></li><li><a href="#step-4-add-storage">Step 4: Add Storage</a></li><li><a href="#step-5-add-tags">Step 5: Add Tags</a></li><li><a href="#step-6-configure-security-group">Step 6: Configure Security Group</a></li><li><a href="#step-7-review-instance-launch">Step 7: Review Instance Launch</a></li></ul></li><li><a href="#eip-할당">EIP 할당</a></li><li><a href="#web-server-구성">Web server 구성</a><ul class="nav"><li><a href="#nodejs-설치">Node.js 설치</a></li><li><a href="#adding-rule-to-a-security-group">Adding Rule to a Security group</a></li></ul></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav"><li class=""><a href="#hello-aws">Hello AWS!</a><ul class="nav"><li><a href="#진행-순서">진행 순서</a></li><li><a href="#vpc-구성">VPC 구성</a><ul class="nav"><li><a href="#step1-select-vpc-configuration">Step1: Select VPC Configuration</a></li><li><a href="#step2">Step2</a></li></ul></li><li><a href="#ec2-구성">EC2 구성</a><ul class="nav"><li><a href="#step1-choose-an-amazon-machine-imageami">Step1: Choose an Amazon Machine Image(AMI)</a></li><li><a href="#step2-choose-an-instance-type">Step2: Choose an Instance Type</a></li><li><a href="#step-3-configure-instance-details">Step 3: Configure Instance Details</a></li><li><a href="#step-4-add-storage">Step 4: Add Storage</a></li><li><a href="#step-5-add-tags">Step 5: Add Tags</a></li><li><a href="#step-6-configure-security-group">Step 6: Configure Security Group</a></li><li><a href="#step-7-review-instance-launch">Step 7: Review Instance Launch</a></li></ul></li><li><a href="#eip-할당">EIP 할당</a></li><li><a href="#web-server-구성">Web server 구성</a><ul class="nav"><li><a href="#nodejs-설치">Node.js 설치</a></li><li><a href="#adding-rule-to-a-security-group">Adding Rule to a Security group</a></li></ul></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>

</body>
